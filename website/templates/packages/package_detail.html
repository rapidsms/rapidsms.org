{% extends "base.html" %}

{% block title %}{{ object }}{% endblock title %}
{% block body_id %}package-detail{% endblock body_id %}

{% block content %}
{% load related_projects %}
<div class="page-header">
    <h1 class="header-split">
        <span class="header-title"><i class="icon-white icon-archive"></i> {{ object }}{% if object.version %} <small>version {{ object.version }}</small>{% endif %}</span>
        {% if user.is_authenticated %}
        <span class="header-buttons">
            <a href="{{ object.get_edit_url }}" class="btn btn-inverse"><i class="icon-white icon-pencil"></i> Edit</a>
            <a href="{{ object.get_flag_url }}" class="btn btn-inverse"><i class="icon-white icon-flag"></i> Flag</a>
        </span>
        {% endif %}
    </h1>
    {% if object.summary %}<div class="summary">{{ object.summary }}</div>{% endif %}
</div>

<div class="row-fluid">
    <div id="left-panel" class="span3">
        {% if object.home_url or object.docs_url or object.tests_url or object.repo_url %}
        <div id="links">
        {% if object.home_url %}
            <a href="{{ object.home_url }}" class="btn btn-inverse btn-block"><i class="icon-white icon-home"></i> Home Page</a>
        {% endif %}
        {% if object.docs_url %}
            <a href="{{ object.docs_url }}" class="btn btn-inverse btn-block"><i class="icon-white icon-book"></i> Documentation</a>
        {% endif %}
        {% if object.tests_url %}
            <a href="{{ object.tests_url }}" class="btn btn-inverse btn-block"><i class="icon-white icon-bug"></i> Tests</a>
        {% endif %}
        {% if object.repo_url %}
            <a href="{{ object.repo_url }}" class="btn btn-inverse btn-block"><i class="icon-white icon-code"></i> Source Code</a>
        {% endif %}
        </div>
        {% endif %}
        {% if object.version or object.release_date %}
            <p>
                <strong>Current Release</strong><br />
                {{ object.version }}<br />
                {% if object.release_date %}released {{ object.release_date|date }}{% endif %}
            </p>
        {% endif %}
        <p>
            <strong>Package Type</strong><br />
            RapidSMS {{ object.get_pkg_type_display }}
        </p>
        {% if object.author_name or object.author_email %}
        <p>
            <strong>Author</strong><br />
            {% if object.author_name and object.author_email %}
            {{ object.author_name }} (<a href="mailto:{{ object.author_email }}">{{ object.author_email }}</a>)
            {% elif object.author_name %}
            {{ object.author_name }}
            {% else %}
            <a href="mailto:{{ object.author_email }}">{{ object.author_email }}</a>
            {% endif %}
        </p>
        {% endif %}
        {% if object.maintainer_name or object.maintainer_email %}
        <p>
            <strong>Maintainer</strong><br />
            {% if object.maintainer_name and object.maintainer_email %}
            {{ object.maintainer_name }} (<a href="mailto:{{ object.maintainer_email }}">{{ object.maintainer_email }}</a>)
            {% elif object.maintainer_name %}
            {{ object.maintainer_name }}
            {% else %}
            <a href="mailto:{{ object.maintainer_email }}">{{ object.maintainer_email }}</a>
            {% endif %}
        </p>
        {% endif %}
        {% if object.license %}
        <p>
            <strong>License</strong><br />
            {{ object.license }}
        </p>
        {% endif %}

        <!-- TAXONOMY -->
        {% with tags=object.tags.all %}
        {% if tags %}
        <p>
            <strong>Taxonomy</strong><br />
            {% for tag in object.tags.all %}
            <span class="label {% cycle 'label-success' 'label-info' 'label-inverse'%}"><a href="{% url 'haystack_search' %}?q={{tag}}">{{ tag }}</a></span>
            {% endfor %}
        </p>
        {% endif %}
        {% endwith %}

        <!-- RELATED PROJECTS -->
        <p><strong>Related Projects</strong></p>
        {% show_related_projects object as related_projects%}
        {% for related_project in related_projects %}
            <p><a href="{{related_project.get_absolute_url }}">{{related_project.name}}</a></p>
        {% endfor %}
    </div>

    <div id="right-panel" class="span9">
        {% if object.description %}{{ object.description|safe }}{% endif %}
    </div>
</div>
{% endblock %}
